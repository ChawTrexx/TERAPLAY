<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Firebase Chat Demo</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body { background:#f0f0f0; font-family:sans-serif; }
  #chat { height:70vh; overflow-y:auto; padding:10px; }
</style>
</head>
<body class="flex flex-col items-center justify-center h-screen p-4">

<div class="flex flex-col w-full max-w-md bg-white border rounded-lg shadow-lg h-full">
  <div class="p-4 bg-green-500 text-white font-semibold rounded-t-lg">Chat Demo</div>
  <div id="chat" class="flex-1 overflow-y-auto space-y-2"></div>
  <div class="flex p-4 border-t space-x-2">
    <input id="messageInput" type="text" placeholder="Type a message..." class="flex-1 border rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
    <button id="sendBtn" class="bg-green-500 text-white px-4 py-2 rounded-full">Send</button>
  </div>
</div>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyALvB7xgYjhBZi5y2JSBamDysNdgIm2mEo",
    authDomain: "wechat-54b07.firebaseapp.com",
    projectId: "wechat-54b07",
    storageBucket: "wechat-54b07.firebasestorage.app",
    messagingSenderId: "221397223557",
    appId: "1:221397223557:web:40703bc5c13dc1b2ab81ec",
    measurementId: "G-XJRYS6DHLR",
    databaseURL: "https://wechat-54b07-default-rtdb.firebaseio.com/"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const chat = document.getElementById('chat');
  const input = document.getElementById('messageInput');
  const sendBtn = document.getElementById('sendBtn');

  function addMessage(text, isSent) {
    const div = document.createElement('div');
    div.className = `max-w-xs px-4 py-2 rounded-lg ${isSent ? 'bg-green-500 text-white ml-auto rounded-br-none' : 'bg-gray-200 text-gray-800 rounded-bl-none'}`;
    div.textContent = text;
    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
  }

  function sendMessage() {
    const msg = input.value.trim();
    if(!msg) return;

    // Push to Firebase
    db.ref('messages').push({ text: msg, sender: 'me' });
    input.value = '';
  }

  sendBtn.addEventListener('click', sendMessage);
  input.addEventListener('keydown', e => { if(e.key === 'Enter') sendMessage(); });

  // Listen for new messages
  db.ref('messages').on('child_added', snapshot => {
    const msg = snapshot.val();
    const isSent = msg.sender === 'me';
    addMessage(msg.text, isSent);
  });
</script>

</body>
</html>
