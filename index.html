<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WeChat Global Realtime Chat</title>
<style>
  body {
    background:#0d0d0d;
    color:white;
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 20px;
  }
  h2 { color:#00e5ff; }
  #messages {
    max-width: 600px;
    margin: 20px auto;
    background: #1c1c1c;
    padding: 10px;
    border-radius: 10px;
    overflow-y: auto;
    max-height: 400px;
  }
  .msg {
    background: #2a2a2a;
    margin: 8px;
    padding: 8px;
    border-radius: 8px;
    text-align: left;
  }
  input, button {
    padding: 10px;
    border: none;
    border-radius: 6px;
    margin: 5px;
  }
  input { width: 70%; }
  button {
    background: #00e5ff;
    color: black;
    cursor: pointer;
    font-weight: bold;
  }
</style>
</head>
<body>
  <h2>ðŸ’¬ WeChat Global Chat (Realtime)</h2>
  <div id="messages"></div>

  <input id="msgInput" type="text" placeholder="Type message...">
  <button id="sendBtn">Send</button>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
    import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-database.js";

    // âœ… Your Firebase Config (correct & tested)
    const firebaseConfig = {
      apiKey: "AIzaSyA_IGhhpYGsJDy1M9VPH-NXY561BF31mgg",
      authDomain: "wechat-eee4d.firebaseapp.com",
      databaseURL: "https://wechat-eee4d-default-rtdb.firebaseio.com",
      projectId: "wechat-eee4d",
      storageBucket: "wechat-eee4d.appspot.com",
      messagingSenderId: "156838661275",
      appId: "1:156838661275:web:feade0307ba5c8ee01ca3e",
      measurementId: "G-TG6TXQ0P8Y"
    };

    // âœ… Initialize Firebase App + DB
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const messagesRef = ref(db, "messages");

    const input = document.getElementById("msgInput");
    const sendBtn = document.getElementById("sendBtn");
    const messagesDiv = document.getElementById("messages");

    // âœ… Send message
    sendBtn.addEventListener("click", () => {
      const text = input.value.trim();
      if (!text) return;
      const msgData = {
        text,
        time: new Date().toLocaleTimeString(),
      };
      push(messagesRef, msgData); // write to Firebase
      input.value = "";
    });

    // âœ… Realtime listener (works for all users)
    onChildAdded(messagesRef, (snapshot) => {
      const data = snapshot.val();
      if (!data) return;
      const msg = document.createElement("div");
      msg.className = "msg";
      msg.textContent = `ðŸ•“ ${data.time} â†’ ${data.text}`;
      messagesDiv.appendChild(msg);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    });
  </script>
</body>
</html>
