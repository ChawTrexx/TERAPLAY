<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sound Buttons UI</title>

<style>
body {
  background:#f5f5f5;
  margin:0;
  font-family:Arial, sans-serif;
}

.header {
  background:#e91e63;
  color:white;
  padding:15px;
  font-size:24px;
  font-weight:bold;
  text-align:center;
}

.grid {
  display:grid;
  grid-template-columns:repeat(3, 1fr);
  gap:20px;
  padding:20px;
}

.sound-box {
  text-align:center;
}

.title {
  font-size:14px;
  margin:8px 0;
  font-weight:bold;
}

.btn-row {
  display:flex;
  justify-content:center;
  gap:10px;
  margin-top:8px;
}

.btn-row img {
  width:22px;
  height:22px;
  cursor:pointer;
}

/* Toggle Upload Box */
#uploadBox {
  background:#fff;
  padding:20px;
  margin:15px;
  border-radius:10px;
  display:none;
  box-shadow:0 4px 10px rgba(0,0,0,0.1);
}

/* Upload Box button */
.toggle-btn {
  background:#e91e63;
  color:white;
  padding:12px;
  width:90%;
  margin:10px auto;
  display:block;
  border:none;
  border-radius:10px;
  font-size:18px;
}
</style>
</head>
<body>

<div class="header">MyInstants Clone</div>

<button class="toggle-btn" onclick="toggleUpload()">Upload Sound ▼</button>

<div id="uploadBox">
  <input type="text" id="title" placeholder="Enter title" style="width:100%;padding:10px;border-radius:8px;border:1px solid #ccc;">
  <br><br>
  <input type="file" id="fileInput" accept="audio/mp3,audio/mpeg" style="width:100%;">
  <br><br>
  <button onclick="uploadSound()" style="width:100%;padding:10px;background:#4caf50;color:white;border:none;border-radius:8px;font-size:16px;">Upload</button>
</div>

<div class="grid" id="soundGrid"></div>

<script type="module">
/* ---------------- Firebase ---------------- */
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getDatabase, ref, set, onValue, remove } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";
import { getStorage, ref as sRef, uploadBytes, getDownloadURL, deleteObject } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-storage.js";

const firebaseConfig = {
  apiKey: "AIzaSyBEo_4YpF_vLH8WtacVKU2YC1BaoIZ7TtI",
  authDomain: "videohosting-13776.firebaseapp.com",
  databaseURL: "https://videohosting-13776-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "videohosting-13776",
  storageBucket: "videohosting-13776.firebasestorage.app",
  messagingSenderId: "992909501546",
  appId: "1:992909501546:web:3728b48ec4727a5679d613",
  measurementId: "G-Q0YQVS6QJ6"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const storage = getStorage(app);

/* ---------------- Upload Toggle ---------------- */
function toggleUpload(){
  let box = document.getElementById("uploadBox");
  box.style.display = box.style.display === "none" ? "block" : "none";
}

/* ---------------- Upload Sound ---------------- */
window.uploadSound = async () => {
  const title = document.getElementById("title").value.trim();
  const file = document.getElementById("fileInput").files[0];
  if(!title) return alert("Enter title");
  if(!file) return alert("Choose mp3 file");

  const filePath = "sounds/" + Date.now() + "_" + file.name;
  const storageRef = sRef(storage, filePath);

  await uploadBytes(storageRef, file);
  const url = await getDownloadURL(storageRef);

  const id = Date.now();
  await set(ref(db, "sounds/"+id), {id, title, url, filePath});

  alert("Uploaded!");
  location.reload();
};

/* ---------------- Load Sounds ---------------- */
const soundGrid = document.getElementById("soundGrid");

onValue(ref(db, "sounds"), (snap)=>{
  soundGrid.innerHTML = "";
  snap.forEach(child=>{
    const s = child.val();

    soundGrid.innerHTML += `
      <div class="sound-box">
        
        <!-- Glossy Button -->
        <button onclick="new Audio('${s.url}').play()" class="cursor-pointer">
          <div class="w-[83px] h-[83px] bg-blue-50 rounded-full relative shadow-[inset_0px_0px_1px_1px_rgba(0,0,0,0.3),_2px_3px_5px_rgba(0,0,0,0.1)] flex items-center justify-center">
            <div class="absolute w-[72px] h-[72px] z-10 bg-black rounded-full left-1/2 -translate-x-1/2 top-[5px] blur-[1px]"></div>
            <label class="group cursor-pointer absolute w-[72px] h-[72px] bg-gradient-to-b from-blue-600 to-blue-400 rounded-full left-1/2 -translate-x-1/2 top-[5px] shadow-[inset_0px_4px_2px_#60a5fa,inset_0px_-4px_0px_#1e3a8a,0px_0px_2px_rgba(0,0,0,10)] active:shadow-[inset_0px_4px_2px_rgba(96,165,250,0.5),inset_0px_-4px_2px_rgba(37,99,235,0.5),0px_0px_2px_rgba(0,0,0,10)] z-20 flex items-center justify-center">
              <div class="w-8 group-active:w-[31px] fill-blue-100 drop-shadow-[0px_2px_2px_rgba(0,0,0,0.5)]">
                ▶️
              </div>
            </label>
          </div>
        </button>

        <div class="title">${s.title}</div>

        <div class="btn-row">
          <img src="https://cdn-icons-png.flaticon.com/512/1828/1828884.png" onclick="copyLink('${s.url}')">
          <img src="https://cdn-icons-png.flaticon.com/512/929/929610.png" onclick="shareSound('${s.url}')">
          <img src="https://cdn-icons-png.flaticon.com/512/1214/1214428.png" onclick="deleteSound('${s.id}','${s.filePath}')">
        </div>

      </div>
    `;
  });
});

/* ---------------- Actions ---------------- */
window.copyLink = (url) => {
  navigator.clipboard.writeText(url);
  alert("Copied!");
};

window.shareSound = async (url) => {
  if(navigator.share){
    navigator.share({title:"Sound", url});
  } else alert("Share not supported");
};

window.deleteSound = async (id, path) => {
  if(!confirm("Delete this?")) return;

  await remove(ref(db,"sounds/"+id));
  await deleteObject(sRef(storage,path));
  alert("Deleted!");
  location.reload();
};
</script>

</body>
</html>
